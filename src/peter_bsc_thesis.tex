%\documentclass[11pt,a4paper,oneside]{report}

\documentclass[11pt,a4paper,twoside,openright]{report}  % Duplex
%\usepackage{hyperref}             % Single-side
\input{include/packages}

%TODO Set the main variables
\newcommand{\vikszerzoVezeteknev}{Nyilas}
\newcommand{\vikszerzoKeresztnev}{Péter}

\newcommand{\vikkonzulensAMegszolitas}{dr.~}
\newcommand{\vikkonzulensAVezeteknev}{Hullám}
\newcommand{\vikkonzulensAKeresztnev}{Gábor}

\newcommand{\vikcim}{
Training and Interpretation of a Neural Network Model for Traffic Object Detection}
% Cím
\newcommand{\viktanszek}{\bmemit} % Tanszék
\newcommand{\vikdoktipus}{\bsc} % Dokumentum típusa (\bsc vagy \msc)
\newcommand{\vikmunkatipusat}{szakdolgozatot} % a "hallgató nyilatkozat" részhez: szakdolgozatot vagy diplomatervet

\input{include/tdk-variables}
\newcommand{\szerzoMeta}{\vikszerzoVezeteknev{} \vikszerzoKeresztnev} % egy szerző esetén
%\newcommand{\szerzoMeta}{\vikszerzoVezeteknev{} \vikszerzoKeresztnev, \tdkszerzoB} % két szerző esetén

%TODO Language configuration -- choose one
% Beállítások magyar nyelvű dolgozathoz
%\input{include/thesis-hu}
% Settings for English documents
\input{include/thesis-en}

\input{include/preamble}

%--------------------------------------------------------------------------------------
% Table of contents and the main text
%--------------------------------------------------------------------------------------
\begin{document}

\pagenumbering{gobble}

%TODO These includes define guidelines -- remove these
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%\include{include/guideline}
%\include{include/project}
\includepdf{include/Kozlekedesi-objektumok-detekciojat-megvalosito-Feladatkiiras.pdf}

\selectthesislanguage

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\include{include/titlepage}		   % Szakdolgozat/Diplomaterv címlap

\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}
% Table of Contents
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\tableofcontents\cleardoublepage


% Declaration and Abstract
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\include{include/declaration} %TODO Hallgatói nyilatkozat -- TDK és OTDK esetén törlendő!
\include{content/abstract}    %TODO Összefoglaló -- TDK és OTDK esetén nem kötelező


% The main part of the thesis
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\pagenumbering{arabic}
\section{Introduction and Motivations}\label{sec:introduction}
%értelmezés
The accurate detection of objects that are relevant to the movement of vehicles is a critical task in the field of automotive and transportation systems.
Numerous scenarios can arise where different types of object detection is required.
The development of a highly sophisticated automated driving system requires the efficient gathering and processing of data from sensors located in the chassis to create a virtual model of the surrounding world.

%tervezés célja
The primary challenge of developing autonomous vehicles is the development of systems  to create a reliable and accurate perception of the vehicle's environment.
One of the most widely used solutions is the use of camera sensors as they are able to
provide rich visual data that can be processed rapidly and can give the most information by itself. The goal of this project was to develop a software capable of fully fulfilling this need.

%értelmezés
Nevertheless, the most significant limitation of these models is that they are frequently regarded as black boxes, lacking a straightforward correlation between input and output.
This lack of transparency in how models arrive at conclusions has led to the development of numerous model interpretation techniques, as evidenced by the work of a number of different researchers~\cite{LIANG2021168}.
These techniques vary in their approach, but they are all aiming to facilitate an insight into the decision-making process of the model.

%feladat indokoltsága
The complexity of interpreting models in these domains arises from the intricate nature of the data and the sheer size of models used.
This complexity makes it challenging to trace the decision-making process, yet it is essential for identifying potential biases,
improving model performance, and gaining the trust of users and regulatory bodies.
Therefore, with the will of enhancing the interpretability of this project's model is vital for maintaining safety and ethical standards, given the nature of the application.

%tervezés célja
The secondary goal of this project was to try and implement different interpretation methods,
aimed to interpret the model and try to create explanations locally about the output our model produces.


\subsection{Structure}\label{subsec:Structure} % felépítés rövid összefoglalása

The main parts of my thesis are as follows:

\begin{itemize}
    \item Literature study about Image processing Deep Convolutional Neural Networks
    \item Yolo architecture and general overview on training and infrastructure.
    \item Cityscapes Dataset and data processing and representation.
    \item Evaluation of model performance
    \item Literature review about model-agnostic and  model-dependent interpretation methods
    \item Implementation, use and evaluation of EigenCAM, LIME and SHAP.
    \item To analyze the results and draw conclusions on the effectiveness of the model and the XAI solutions for traffic object detection.
\end{itemize}
\section{Image Processing Deep Neural Networks}\label{sec:image-processing-deep-neural-networks}
\input{part0}

\section[Chosen model, training and data management]{The Model, its training and data management} \label{sec:model-training-data}
\input{part1}


%----------------------------------------------------------------------------------------%

\input{part2}

\section{Model interpretation using external solutions}\label{sec:model-interpretation-application}
\input{part3}


% Summary
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\section*{Summary}
\addcontentsline{toc}{chapter}{Summary}

This document presents a comprehensive study on the training and interpretation of a neural network
model for traffic object detection.
The key points discussed in the chapters are summarized as follows:

\begin{itemize}
    \item **Model, Training, and Data**: The YOLOv8 model architecture, including its backbone, neck, and head components, is detailed. The training process and the Cityscapes dataset used for training are also discussed.
    \item **Model Interpretation Using External Solutions**: The importance of model interpretation is highlighted. Various model-agnostic methods such as LIME and SHAP, as well as model-specific methods like EigenCAM and EigenGradCAM, are explained.
\end{itemize}

The study concludes that effective training and interpretation of neural network models are crucial for accurate and reliable traffic object detection.





% Acknowledgements
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%\include{content/acknowledgement}


% List of Figures, Tables
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%\listoffigures\addcontentsline{toc}{chapter}{\listfigurename}
%\listoftables\addcontentsline{toc}{chapter}{\listtablename}


% Bibliography
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\addcontentsline{toc}{chapter}{\bibname}
\bibliography{bib/mybib}


% Appendix
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%include{content/appendices}

%\label{page:last}
\end{document}
